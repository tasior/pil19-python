<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <link rel="manifest" href="/static/manifest.webmanifest" />
  <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rolety 2.0</title>

  <link href="/css/bootstrap-5.3.0.min.css" rel="stylesheet">

  <script src="/js/deviceid.js"></script>
  <script src="/js/socket.js"></script>
  <script src="/js/bootstrap-5.3.0.bundle.min.js"></script>

  <style>
    html,
    body {
      height: 100%;
    }

    .bi {
      display: inline-block;
      vertical-align: -.125em;
      fill: currentcolor;
    }

    .em-1 {
      width: 1em;
      height: 1em;
    }

    .em-2 {
      width: 2em;
      height: 2em;
    }

    .w-2em {
      width: 2em !important;
    }

    #menu .list-group {
      --bs-list-group-active-bg: var(--bs-list-group-action-active-bg);
      --bs-list-group-active-border-color: var(--bs-list-group-border-color);
    }

    #menu .list-group .list-group-item {
      border-right-width: 0;
      border-left-width: 0;
    }
  </style>
</head>

<body style="--bs-body-font-weight: 300;">
  <div class="container-xxl text-center h-100">
    <div id="pages" class="carousel slide shadow-lg h-100" data-bs-animation="50">
      <div class="carousel-inner h-100">
        <div class="carousel-item h-100 active">
          <div class="row text-center justify-content-center">
            <div class="col col-9 col-md-4 col-xl-3 p-5">
              <div class="card border border-top-0 m-auto" data-bs-theme="light" style="/* width: 55vw; */">
                <div class="card-header p-0 bg-dark-subtle" style="border: 1px solid white;border-width: 0 10px 0 10px;">
                  <div class="position-relative w-100 h-100" style="border: 1px solid black;border-width: 30px 10px 60px 10px;">
                    <div class="position-absolute start-0 w-100 h-100 translate-top z-3">
                      <select id="pilot-channel" class="opacity-0 w-100 h-100">
                        <option value="0" data-channel-name="Wszystkie">00 Wszystkie</option>
                        <option value="1" data-channel-name="Salon">01 Salon</option>
                        <option value="2" data-channel-name="Taras">02 Taras</option>
                      </select>
                    </div>
                    <label id="pilot-channel-label" for="pilot-channel">
                      <div class="channel-no fw-semibold" style="font-size: 5.5rem!important;">00</div>
                      <div class="channel-name p-2">Wszystkie</div>
                    </label>
                  </div>
                </div>
                <div style="border: 1px solid white;border-width: 0 10px 0 10px;">
                  <div class="vstack gap-1 py-2 px-1 border border-light-subtle">
                    <button type="button" class="btn btn-outline-secondary rounded-0 p-0 border border-light-subtle">
                      <div class="w-100 p-2 text-black border border-secondary-subtle border-top-0 border-start-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-fill em-2" viewBox="0 0 16 16">
                          <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"></path>
                        </svg>
                      </div>
                    </button>
                    <button type="button" class="btn btn-outline-secondary rounded-0 p-0 border border-light-subtle">
                      <div class="w-100 p-2 text-black border border-secondary-subtle border-top-0 border-start-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stop-fill em-2" viewBox="0 0 16 16">
                          <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5z"></path>
                        </svg>
                      </div>
                    </button>
                    <button type="button" class="btn btn-outline-secondary rounded-0 p-0 border border-light-subtle">
                      <div class="w-100 p-2 text-black border border-secondary-subtle border-top-0 border-start-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-fill em-2" viewBox="0 0 16 16">
                          <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"></path>
                        </svg>
                      </div>
                    </button>

                  </div>
                </div>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">&nbsp;<br>&nbsp;</li>
                  <li class="list-group-item">
                    <div class="btn-group w-100" role="group" aria-label="Basic radio toggle button group" data-bs-theme="dark">
                      <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked="">
                      <label class="btn btn-outline" for="btnradio1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-archive-fill" viewBox="0 0 16 16">
                          <path d="M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15h9.286zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zM.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8H.8z"></path>
                        </svg> Rolety
                      </label>

                      <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                      <label class="btn btn-outline" for="btnradio2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-collection-fill" viewBox="0 0 16 16">
                          <path d="M0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zM2 3a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 0-1h-11A.5.5 0 0 0 2 3zm2-2a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7A.5.5 0 0 0 4 1z"></path>
                        </svg> Grupy
                      </label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="carousel-item">
          Rolety
        </div>
        <div class="carousel-item">
          Grupy
        </div>
        <div class="carousel-item">
          Harmonogramy
        </div>
        <div class="carousel-item">
          Ustawienia
        </div>
      </div>
    </div>

    <div class="fixed-bottom text-end p-4">
      <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#menu"
        aria-controls="menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
          class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
          <path
            d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
        </svg>
      </button>
    </div>
  </div>

  <!-- MENU -->
  <div class="offcanvas offcanvas-bottom" tabindex="-1" id="menu" aria-labelledby="menuLabel"
    style="--bs-offcanvas-height: 40vh;" data-bs-theme="dark">
    <div class="offcanvas-header">
      <p class="offcanvas-title fs-4 fw-light" id="menuLabel">
        Menu
      </p>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
      <div class="list-group rounded-0">
        <a href="#" class="list-group-item list-group-item-action active" data-bs-target="#pages" data-bs-slide-to="0"
          aria-current="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pc"
            viewBox="0 0 16 16">
            <path
              d="M5 0a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1H5Zm.5 14a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1Zm2 0a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1ZM5 1.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5ZM5.5 3h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1Z" />
          </svg> Pilot
        </a>
        <a href="#" class="list-group-item list-group-item-action" data-bs-target="#pages" data-bs-slide-to="1">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-archive-fill"
            viewBox="0 0 16 16">
            <path
              d="M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15h9.286zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zM.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8H.8z" />
          </svg> Rolety
        </a>
        <a href="#" class="list-group-item list-group-item-action" data-bs-target="#pages" data-bs-slide-to="2">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-collection-fill" viewBox="0 0 16 16">
            <path
              d="M0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zM2 3a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 0-1h-11A.5.5 0 0 0 2 3zm2-2a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7A.5.5 0 0 0 4 1z" />
          </svg> Grupy
        </a>
        <a href="#" class="list-group-item list-group-item-action" data-bs-target="#pages" data-bs-slide-to="3">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-calendar-week-fill" viewBox="0 0 16 16">
            <path
              d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zM9.5 7h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm3 0h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zM2 10.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3.5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5z" />
          </svg> Harmonogramy
        </a>
        <a href="#" class="list-group-item list-group-item-action" data-bs-target="#pages" data-bs-slide-to="4">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill"
            viewBox="0 0 16 16">
            <path
              d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z" />
          </svg> Ustawienia
        </a>
      </div>
    </div>
  </div>

  <script>
    const deviceId = getDeviceId();
    var app_config = {};
    const socket = createWebSocket(deviceId, location.host, 'ws');

    const pagesElement = document.querySelector('#pages');
    const pagesCarousel = new bootstrap.Carousel(pagesElement);
    pagesElement.addEventListener('slide.bs.carousel', event => {
      document.querySelectorAll('#menu [data-bs-slide-to]').forEach(e => e.classList.remove('active'));
      document.querySelector('#menu [data-bs-slide-to="' + event.to + '"]').classList.add('active');
    });

    const pilotChannel = document.querySelector('#pilot-channel');
    const pilotChannelLabel = document.querySelector('#pilot-channel-label');
    pilotChannel.addEventListener('change', () => {
      pilotChannelLabel.querySelector('.channel-no').innerHTML = pilotChannel.value.padStart(2, '0');
      pilotChannelLabel.querySelector('.channel-name').innerHTML = pilotChannel.querySelector('option:checked').getAttribute('data-channel-name');
    });





    const cmd = {
      config_get: 'config:get',
      config_save: 'config:save',
    };

    async function load_config() {
      app_config = await socket.send(cmd.config_get);
      console.log(app_config);
    }

    (async function () {
      await socket.connect();
      socket.on('close', () => console.log('WS CLOSED!!!'));
      await load_config();
    })();
  </script>
</body>

</html>